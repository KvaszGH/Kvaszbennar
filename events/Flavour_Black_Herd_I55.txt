################################################
##              Creator: Blaziy               ##
##               Writer: Parkor               ##
################################################

namespace = black_herd_events

country_event = { #The Last Shamans
	id = black_herd_events.0
	title = black_herd_events.0.t
	desc = black_herd_events.0.desc
	picture = LOOMING_DEATH_eventPicture

	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		tag = I55 #Black Herd
	}

	option = {
		name = black_herd_events.0.a
		set_country_flag = annexed_non_monstrous
		set_estate_privilege = estate_mages_monstrous_regiment
		capital_scope = {
			add_culture_construction = {
				cost = 0
				speed = 0.25
			}
		}
		custom_tooltip = I55_no_ogre_subject_tt
	}
}

country_event = { #Leaflets of The Glutton King
	id = black_herd_events.1
	title = black_herd_events.1.t
	desc = black_herd_events.1.desc
	picture = BIG_BOOK_eventPicture

	is_triggered_only = yes

	option = {
		name = black_herd_events.1.a
		set_country_flag = I55_project_unlock
		set_country_flag = I55_lichdom_project_unlock
		custom_tooltip = I55_lichdom_project_unlock_tt
		add_ruler_modifier = {
			name = exceptional_willpower_100
			duration = -1
		}
		set_country_flag = I55_reveal_necromancy_missions_flag
		swap_non_generic_missions = yes
	}
}

country_event = { #Cauterizing History
	id = black_herd_events.2
	title = black_herd_events.2.t
	desc = black_herd_events.2.desc
	picture = FIREBALL_eventPicture

	is_triggered_only = yes

	option = {
		name = black_herd_events.2.a
		set_country_flag = I55_project_unlock
		set_country_flag = I55_markhentakruan_project_unlock
		custom_tooltip = I55_project_unlock_tt
	}
}

country_event = { #Emblazing The Deep
	id = black_herd_events.3
	title = black_herd_events.3.t
	desc = black_herd_events.3.desc
	picture = CAVE_eventPicture

	is_triggered_only = yes

	option = {
		name = black_herd_events.3.a
		increase_witch_king_points_small = yes
		increase_magic_experience = { unmodified_amount = 50 }
	}

	option = {
		name = black_herd_events.3.b
		trigger = { has_mana = { amount = 20 } }
		increase_witch_king_points_medium = yes
		increase_magic_experience = { unmodified_amount = 100 }
		change_mana = { amount = -20 }
	}
}

country_event = { #Ashen Past
	id = black_herd_events.4
	title = black_herd_events.4.t
	desc = black_herd_events.4.desc
	picture = COPTIC_CITY_eventPicture

	is_triggered_only = yes

	option = {
		name = black_herd_events.4.a
		add_treasury = -300
		custom_tooltip = I55_lichdom_potion_tt
		custom_tooltip = I55_home_of_the_greatbound_tt
		set_country_flag = I55_home_of_the_greatbound_flag
		5037 = { #Maghargma
			change_culture = ROOT
			change_religion = ROOT
			hidden_effect = {
				add_province_modifier = {
					name = I55_home_of_the_greatbound
					duration = -1
				}
				add_province_modifier = {
					name = I55_home_of_the_greatbound_sub
					duration = -1
					hidden = yes
				}
			}
		}
	}
}

country_event = { #Starlight
	id = black_herd_events.5
	title = black_herd_events.5.t
	desc = black_herd_events.5.desc
	picture = BIG_STAR_IN_SKY_eventPicture

	is_triggered_only = yes

	option = {
		name = black_herd_events.5.a
		change_adm = 1
		change_dip = 1
		custom_tooltip = I55_enable_formables_tt
	}

	option = {
		name = black_herd_events.5.b
		change_adm = 1
		change_mil = 1
		custom_tooltip = I55_enable_formables_tt
	}

	option = {
		name = black_herd_events.5.c
		change_dip = 1
		change_mil = 1
		custom_tooltip = I55_enable_formables_tt
	}

	after = { set_country_flag = I55_enable_formables_flag }
}

country_event = { #Event to give you a consort to kill
	id = black_herd_events.7
	title = none
	desc = none
	picture = none

	is_triggered_only = yes
	fire_only_once = yes
	hidden = yes

	option = {
		name = none
		if = {
			limit = { has_consort = no }
			define_consort = { }
		}
	}
}

country_event = { #To break vassalization
	id = black_herd_events.8
	title = none
	desc = none
	picture = none

	is_triggered_only = yes
	hidden = yes

	option = {
		name = none
		grant_independence = yes
	}
}

##################################
# Magical Project Events #

#Stage 1
country_event = { #Illuminating Shadows
	id = black_herd_events.10
	title = black_herd_events.10.t
	desc = black_herd_events.10.desc
	picture = MAGIC_STUDY_AND_RELAX_eventPicture

	is_triggered_only = yes

	option = {
		name = black_herd_events.10.a
		if = {
			limit = { has_adm_advisor = yes }
			set_country_flag = I55_adm_advisor_project_flag
			custom_tooltip = I55_adm_advisor_bonus_1_tt
		}
		else_if = {
			limit = { has_dip_advisor = yes }
			set_country_flag = I55_dip_advisor_project_flag
			custom_tooltip = I55_dip_advisor_bonus_1_tt
		}
		else_if = {
			limit = { has_mil_advisor = yes }
			set_country_flag = I55_mil_advisor_project_flag
			custom_tooltip = I55_mil_advisor_bonus_1_tt
		}
	}
}

country_event = { #Lighting The Path
	id = black_herd_events.11
	title = black_herd_events.11.t
	desc = black_herd_events.11.desc
	picture = BONFIRE_OF_THE_VANITIES_eventPicture

	is_triggered_only = yes

	option = {
		name = black_herd_events.11.a
		trigger = {
			hidden_trigger = {
				OR = {
					has_country_flag = I55_adm_advisor_project_flag
					has_country_flag = I55_dip_advisor_project_flag
					has_country_flag = I55_mil_advisor_project_flag
				}
			}
		}
		highlight = yes
		increase_magic_experience = { unmodified_amount = 50 }
		if = {
			limit = { has_country_flag = I55_adm_advisor_project_flag }
			custom_tooltip = I55_adm_advisor_bonus_2_tt
		}
		else_if = {
			limit = { has_country_flag = I55_dip_advisor_project_flag }
			custom_tooltip = I55_dip_advisor_bonus_2_tt
		}
		else_if = {
			limit = { has_country_flag = I55_mil_advisor_project_flag }
			custom_tooltip = I55_mil_advisor_bonus_2_tt
		}
	}

	option = {
		name = black_herd_events.11.a #Same option loc
		trigger = {
			hidden_trigger = {
				NOT = {
					has_country_flag = I55_adm_advisor_project_flag
					has_country_flag = I55_dip_advisor_project_flag
					has_country_flag = I55_mil_advisor_project_flag
				}
			}
		}
	}
}

country_event = { #Hidden Event to give magic experience if earned
	id = black_herd_events.110
	title = none
	desc = none
	picture = none

	is_triggered_only = yes
	hidden = yes

	option = {
		name = none
		increase_magic_experience = { unmodified_amount = 50 }
	}
}

country_event = { #History Ignites
	id = black_herd_events.12
	title = black_herd_events.12.t
	desc = black_herd_events.12.desc
	picture = MAGE_MOON_eventPicture

	is_triggered_only = yes

	option = {
		name = black_herd_events.12.a
		set_custom_spell_list = { group = centaur subgroup = black_herd }
		set_country_flag = black_herd_project_1_complete_flag
		clr_country_flag = I55_adm_advisor_project_flag
		clr_country_flag = I55_dip_advisor_project_flag
		clr_country_flag = I55_mil_advisor_project_flag
		hidden_effect = { set_variable = { markhentakruan_land_units_killed = 20000 } }
	}
}

#Stage 2
country_event = { #Stoke The Flame
	id = black_herd_events.20
	title = black_herd_events.20.t
	desc = black_herd_events.20.desc
	picture = MAGIC_STUDY_AND_RELAX_eventPicture

	is_triggered_only = yes

	option = {
		name = black_herd_events.20.a
		custom_tooltip = I55_causalities_1_tt
		set_country_flag = I55_causalities_project_flag
		hidden_effect = { set_variable = { black_herd_causalities_var = 0 } }
	}
}

country_event = { #Spread The Blaze
	id = black_herd_events.21
	title = black_herd_events.21.t
	desc = black_herd_events.21.desc
	picture = MAGE_MOON_ALTER_eventPicture

	is_triggered_only = yes

	option = {
		name = black_herd_events.21.a
		trigger = { hidden_trigger = { check_variable = { black_herd_causalities_var = 10000 } } }
		highlight = yes
		increase_magic_experience = { unmodified_amount = 50 }
		custom_tooltip = I55_causalities_2_tt
		hidden_effect = { set_variable = { black_herd_causalities_var = 0 } }
	}

	option = {
		name = black_herd_events.21.a #Same option loc
		trigger = { NOT = { check_variable = { black_herd_causalities_var = 10000 } } }
		clr_country_flag = I55_causalities_project_flag
	}
}

country_event = { #Hidden Event to give magic experience if earned
	id = black_herd_events.210
	title = none
	desc = none
	picture = none

	is_triggered_only = yes
	hidden = yes

	option = {
		name = none
		increase_magic_experience = { unmodified_amount = 50 }
	}
}

country_event = { #Raise The Inferno
	id = black_herd_events.22
	title = black_herd_events.22.t
	desc = black_herd_events.22.desc
	picture = MAGE_MOON_eventPicture

	is_triggered_only = yes

	option = {
		name = black_herd_events.22.a
		custom_tooltip = black_herd_project_2_complete_tt
		change_variable = { magic_projects_completed = 1 }
		set_country_flag = black_herd_project_2_complete_flag
		clr_country_flag = I55_causalities_project_flag
	}
}

#Stage 3
country_event = { #Surpassing Ancients
	id = black_herd_events.30
	title = black_herd_events.30.t
	desc = black_herd_events.30.desc
	picture = MAGIC_STUDY_AND_RELAX_eventPicture

	is_triggered_only = yes

	option = {
		name = black_herd_events.30.a
		custom_tooltip = I55_sieges_1_tt
		set_country_flag = I55_sieges_project_flag
		hidden_effect = { set_variable = { black_herd_sieges_var = 0 } }
	}
}

country_event = { #Shattering Stone
	id = black_herd_events.31
	title = black_herd_events.31.t
	desc = black_herd_events.31.desc
	picture = SIEGE_eventPicture

	is_triggered_only = yes

	option = {
		name = black_herd_events.31.a
		trigger = { hidden_trigger = { check_variable = { black_herd_sieges_var = 2 } } }
		highlight = yes
		increase_magic_experience = { unmodified_amount = 50 }
		custom_tooltip = I55_sieges_2_tt
		hidden_effect = { set_variable = { black_herd_sieges_var = 0 } }
	}

	option = {
		name = black_herd_events.31.a #Same option loc
		trigger = { NOT = { check_variable = { black_herd_sieges_var = 2 } } }
		clr_country_flag = I55_sieges_project_flag
	}
}

country_event = { #Hidden Event to give magic experience if earned
	id = black_herd_events.310
	title = none
	desc = none
	picture = none

	is_triggered_only = yes
	hidden = yes

	option = {
		name = none
		increase_magic_experience = { unmodified_amount = 50 }
	}
}

country_event = { #Markhentakruan
	id = black_herd_events.32
	title = black_herd_events.32.t
	desc = black_herd_events.32.desc
	picture = MAGE_MOON_eventPicture

	is_triggered_only = yes

	option = {
		name = black_herd_events.32.a
		custom_tooltip = black_herd_project_2_complete_tt
		set_country_flag = black_herd_project_3_complete_flag
		clr_country_flag = I55_sieges_project_flag
	}
}


## Lichdom Events ##

country_event = { #Lichdom 1 - Finding out how to do it
	id = black_herd_events.40
	title = magic_project_lichdom.1.t #These loc keys are intended - Meant to be the same loc
	desc = magic_project_lichdom.1.d
	picture = DEATH_OF_HEIR_eventPicture

	is_triggered_only = yes
	immediate = { set_country_flag = in_magic_progress_event }
    after = { clr_country_flag = in_magic_progress_event }

	option = { #Send Mages to find a lost tome
		name = magic_project_lichdom.1.a
        ai_chance = { factor = 1 }
        add_treasury = -100
        show_magic_project_lichdom_warning = yes
        increase_estate_witch_king_points = { size = small }
		start_magic_project = {
			project = black_herd_project_lichdom
			school = necromancy 
			event_1 = black_herd_events.41
			event_2 = black_herd_events.50
			event_3 = black_herd_events.60
		}
    }

    option = { #I'll find it myself!
		name = magic_project_lichdom.1.b
        ai_chance = { factor = 1 }
        add_adm_power = -50
        add_dip_power = -50
        show_magic_project_lichdom_warning = yes
        increase_ruler_witch_king_points = { size = small }
		start_magic_project = {
			project = black_herd_project_lichdom
			school = necromancy 
			event_1 = black_herd_events.41
			event_2 = black_herd_events.50
			event_3 = black_herd_events.60
		}
    }
}

country_event = { #Lichdom 2 - Phylactery 1 - Constructing the Container
	id = black_herd_events.41
	title = magic_project_lichdom.2.t
	desc = magic_project_lichdom.2.d
	picture = DEATH_OF_HEIR_eventPicture

	is_triggered_only = yes
	immediate = { set_country_flag = in_magic_progress_event }
    after = { clr_country_flag = in_magic_progress_event }

	option = {    #An amulet capable of containing a small object
		name = magic_project_lichdom.2.a
        ai_chance = { factor = 50 }
        
        add_treasury = -100
        add_ruler_modifier = { name = studying_lichdom_amulet duration = -1 }
    }

    option = {    #An ornate, jewel-encrusted box
		name = magic_project_lichdom.2.b
        ai_chance = { factor = 50 }
        
        add_treasury = -200
        add_ruler_modifier = { name = studying_lichdom_box duration = -1 }
    }
}

country_event = { #
	id = black_herd_events.42
	title = magic_project_lichdom.3.t
	desc = magic_project_lichdom.3.d
	picture = PAINTER_ARTIST_eventPicture

	is_triggered_only = yes
	immediate = { set_country_flag = in_magic_progress_event }
    after = { clr_country_flag = in_magic_progress_event }
    
    option = {    #Scribe dark spells on tiny magical parchments to put inside
		name = magic_project_lichdom.3.a
        ai_chance = { factor = 50 }
        
        add_adm_power = -100
        add_ruler_modifier = { name = studying_lichdom_parchment duration = -1 }
    }
    
    option = {    #Carve unholy runes on the interior walls and fill them with liquified Damestear
		name = magic_project_lichdom.3.b
        ai_chance = { factor = 50 }
        
        add_dip_power = -100
        add_ruler_modifier = { name = studying_lichdom_runes duration = -1 }
    }
    
    option = {    #Coat the insides with enchanted blood of a magical beast
		name = magic_project_lichdom.3.c
        ai_chance = { factor = 50 }
        
        add_mil_power = -100
        add_ruler_modifier = { name = studying_lichdom_blood duration = -1 }
    }
}

country_event = { #
	id = black_herd_events.43
	title = magic_project_lichdom.4.t
	desc = magic_project_lichdom.4.d
	picture = MAGE_MOON_eventPicture

	is_triggered_only = yes
	immediate = { set_country_flag = in_magic_progress_event }
    after = { clr_country_flag = in_magic_progress_event }

    option = {    #Perform Dark Enchantments
        name = magic_project_lichdom.4.a
        ai_chance = { factor = 50 }
        
        add_adm_power = -100
        increase_witch_king_points_large = { level = necromancy_level_1_minimum }
        add_ruler_modifier = { name = lichdom_mod_1 duration = -1 }

        custom_tooltip = tooltip_magic_project_advance
    }
}

country_event = { #
	id = black_herd_events.50
	title = magic_project_lichdom.5.t
	desc = magic_project_lichdom.5.d
	picture = TRADE_GOODS_PLANTATION_GOODS_IN_WAREHOUSE_eventPicture

	is_triggered_only = yes
	immediate = { set_country_flag = in_magic_progress_event }
    after = { clr_country_flag = in_magic_progress_event }

	option = {	#Black Herd - Already got a potion
		name = magic_project_lichdom.5.dd

		add_ruler_modifier = { name = studying_lichdom_has_potion duration = -1 }
	}
}

country_event = { #
	id = black_herd_events.51
	title = magic_project_lichdom.6.t
	desc = magic_project_lichdom.6.d
	picture = TRADEGOODS_eventPicture

	is_triggered_only = yes
	immediate = { set_country_flag = in_magic_progress_event }
    after = { clr_country_flag = in_magic_progress_event }

	option = {
		name = magic_project_lichdom.6.dd

		add_ruler_modifier = { name = studying_lichdom_has_potion_2 duration = -1 }
	}
}

country_event = { #
	id = black_herd_events.52
	title = magic_project_lichdom.7.t
	desc = magic_project_lichdom.7.d
	picture = muslimgfx_NEW_HEIR_eventPicture

	is_triggered_only = yes
	immediate = { set_country_flag = in_magic_progress_event }
    after = { clr_country_flag = in_magic_progress_event }

	option = {
		name = magic_project_lichdom.7.dd
		increase_ruler_witch_king_points = { size = large }
		add_ruler_modifier = { name = lichdom_mod_2 duration = -1 }
	}
}

country_event = { #
	id = black_herd_events.60
	title = magic_project_lichdom.8.t
	desc = magic_project_lichdom.8.d
	picture = END_OF_TIME_eventPicture

	is_triggered_only = yes
	immediate = { set_country_flag = in_magic_progress_event }
    after = { clr_country_flag = in_magic_progress_event }

    option = {    #Make the preparations
        name = magic_project_lichdom.8.a
        ai_chance = { factor = 50 }
        
        add_adm_power = -100
        add_dip_power = -100
        add_mil_power = -100
        
        add_ruler_modifier = { name = studying_lichdom_prep duration = -1 }
    }
    
    option = {    #Draw a Circle of Power to improve my chances
        name = magic_project_lichdom.8.b
        trigger = { is_ruler_abjuration_level_2_minimum = yes }
        ai_chance = { factor = 1000 }
        highlight = yes
        
        add_adm_power = -100
        
        add_ruler_modifier = { name = studying_lichdom_circle duration = -1 }
    }
}

country_event = { #
	id = black_herd_events.61
	title = magic_project_lichdom.9.t
	desc = magic_project_lichdom.9.d
	picture = MIRACLE_MONK_eventPicture

	is_triggered_only = yes
	immediate = { set_country_flag = in_magic_progress_event }
    after = { clr_country_flag = in_magic_progress_event }

    option = {    #Begin the cleanse
        name = magic_project_lichdom.9.a
        ai_chance = { factor = 50 }
        
        add_ruler_modifier = {
            name = studying_lichdom_cleansing
            duration = -1
        }
    }
    
    option = {    #Transmutation spells will help quicken the process
        name = magic_project_lichdom.9.b
        trigger = { is_ruler_transmutation_level_2_minimum = yes }
        ai_chance = { factor = 1000 }
        highlight = yes
        
        add_ruler_modifier = {
            name = studying_lichdom_cleansinger
            duration = -1
        }
    }
}

country_event = { #
	id = black_herd_events.62
	title = magic_project_lichdom.10.t
	desc = magic_project_lichdom.10.d
	picture = LOOMING_DEATH_eventPicture

	is_triggered_only = yes
	immediate = { set_country_flag = in_magic_progress_event }
    after = { clr_country_flag = in_magic_progress_event }

    
    option = {    #Drink
        name = magic_project_lichdom.10.a
        ai_chance = { factor = 50 }
        
        remove_country_modifier = studying_lichdom_amulet
        remove_country_modifier = studying_lichdom_box
        remove_country_modifier = studying_lichdom_parchment
        remove_country_modifier = studying_lichdom_runes
        remove_country_modifier = studying_lichdom_blood
        remove_country_modifier = lichdom_mod_1
		remove_country_modifier = studying_lichdom_has_potion
		remove_country_modifier = studying_lichdom_has_potion_2
        remove_country_modifier = lichdom_mod_2
        remove_country_modifier = studying_lichdom_prep
        remove_country_modifier = studying_lichdom_circle
        remove_country_modifier = studying_lichdom_cleansing
        remove_country_modifier = studying_lichdom_cleansinger
        
        tooltip = {
            kill_ruler = yes
            random = {
                chance = 1
                country_event = { id = magic_project_lichdom.11 }
            }
        }
        hidden_effect = {
            play_sound = newmonarch
            country_event = { id = magic_project_lichdom.11 }
        }
    }
}

country_event = { #
	id = black_herd_events.63
	title = magic_project_lichdom.11.t
	desc = magic_project_lichdom.11.d
	picture = PRIEST_PHANTOM_eventPicture

	is_triggered_only = yes
	immediate = { set_country_flag = in_magic_progress_event }
    after = { clr_country_flag = in_magic_progress_event }

	option = {
		name = magic_project_lichdom.11.a

		become_a_lich_effect = yes
		become_a_witch_king_effect = yes
	}
}